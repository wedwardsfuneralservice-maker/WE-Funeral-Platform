<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Create New Funeral Record ‚Äì W.E. Funeral Service Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ========================================= -->
  <!-- ADMIN THEME (MATCHES SUPER ADMIN EXACTLY) -->
  <!-- ========================================= -->
  <style>
    :root {
      --blue: #306cde;
      --blue-soft: rgba(48, 108, 222, 0.13);
      --gold: #f5c242;

      --bg-main-dark: #0d0f12;
      --bg-elevated-dark: #171a22;
      --text-primary-dark: #f9fafb;
      --text-muted-dark: #9ca3af;
      --border-subtle-dark: rgba(148, 163, 184, 0.18);

      --bg-main-light: #f8fafc;
      --bg-elevated-light: #ffffff;
      --text-primary-light: #0f172a;
      --text-muted-light: #6b7280;
      --border-subtle-light: rgba(148, 163, 184, 0.35);

      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 35px rgba(0, 0, 0, 0.45);
    }

    /* BODY THEMES --------------------------------------- */
    body.theme-dark {
      margin: 0;
      font-family: system-ui, sans-serif;
      color: var(--text-primary-dark);
      background:
        radial-gradient(circle at top left, var(--blue-soft), transparent 60%),
        radial-gradient(circle at bottom right, rgba(15, 23, 42, 0.9), #020617);
      display: flex;
      min-height: 100vh;
    }

    body.theme-light {
      margin: 0;
      font-family: system-ui, sans-serif;
      color: var(--text-primary-light);
      background: var(--bg-main-light);
      display: flex;
      min-height: 100vh;
    }

    /* LAYOUT WRAPPER ------------------------------------- */
    .shell {
      display: flex;
      width: 100%;
    }

    /* SIDEBAR -------------------------------------------- */
    .sidebar {
      width: 260px;
      padding: 24px 20px;
      display: flex;
      flex-direction: column;
      gap: 28px;
      box-shadow: 18px 0 40px rgba(0, 0, 0, 0.45);
      z-index: 20;
    }

    body.theme-dark .sidebar {
      background: linear-gradient(180deg, #05060a, #0b0d12 40%, #05060a 100%);
      border-right: 1px solid rgba(148, 163, 184, 0.25);
    }

    body.theme-light .sidebar {
      background: #ffffff;
      border-right: 1px solid var(--border-subtle-light);
      box-shadow: 12px 0 30px rgba(15, 23, 42, 0.06);
    }

/* Multi-step visibility control */
.form-section, section {
  display: none;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.35s ease, transform 0.35s ease;
}

.form-section.active-step, section.active-step {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

/* Navigation buttons */
.step-nav {
  margin-top: 30px;
  display: flex;
  justify-content: space-between;
}

.step-btn {
  padding: 10px 18px;
  border-radius: 999px;
  font-size: 14px;
  cursor: pointer;
  border: none;
  transition: transform 0.15s ease;
}

.step-btn.primary {
  background: linear-gradient(90deg, var(--blue), #5b8bff);
  color: white;
  box-shadow: 0 10px 22px rgba(37, 99, 235, 0.45);
}

.step-btn.secondary {
  background: rgba(148,163,184,0.2);
  color: white;
}

.step-btn:active {
  transform: translateY(1px);
}

    
    /* SIDEBAR BRAND -------------------------------------- */
    .brand-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-title {
      font-size: 18px;
      letter-spacing: 0.14em;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--gold);
    }

    .brand-sub {
      font-size: 12px;
      text-transform: uppercase;
      opacity: 0.75;
    }

    .nav-section-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted-dark);
      margin-bottom: 6px;
    }
    body.theme-light .nav-section-label {
      color: var(--text-muted-light);
    }

    .nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-item {
      border-radius: 999px;
      padding: 8px 12px;
      display: flex;
      gap: 10px;
      align-items: center;
      font-size: 14px;
      cursor: pointer;
      border: 1px solid transparent;
      transition: background 0.18s ease, transform 0.12s ease;
    }

    body.theme-dark .nav-item {
      color: var(--text-muted-dark);
    }
    body.theme-light .nav-item {
      color: var(--text-muted-light);
    }

    .nav-item:hover {
      transform: translateX(2px);
    }

    body.theme-dark .nav-item:hover {
      background: rgba(15, 23, 42, 0.8);
      border-color: rgba(148, 163, 184, 0.3);
    }

    .nav-item.active {
      background: linear-gradient(90deg, var(--blue), #5b8bff);
      color: #fff;
      box-shadow: 0 0 0 1px rgba(147, 197, 253, 0.4);
    }

    /* MAIN AREA ------------------------------------------- */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 24px 28px;
      gap: 24px;
      box-sizing: border-box;
    }

    /* TOP BAR --------------------------------------------- */
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .topbar-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .page-title {
      font-size: 26px;
      font-weight: 700;
    }

    .page-subtitle {
      font-size: 13px;
      opacity: 0.75;
    }

    .topbar-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .avatar-chip {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 99px;
      border: 1px solid rgba(148,163,184,0.4);
    }

    .avatar-circle {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, var(--gold), #4b5563);
    }

    /* CARD WRAPPER ---------------------------------------- */
    .content-card {
      border-radius: var(--radius-lg);
      padding: 26px 30px;
      box-sizing: border-box;
      margin-top: 10px;
    }

    body.theme-dark .content-card {
      background: radial-gradient(circle at top left, rgba(48,108,222,0.22), transparent 60%),
        linear-gradient(145deg, #0b1020, #111827);
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: var(--shadow-soft);
    }

    body.theme-light .content-card {
      background: var(--bg-elevated-light);
      border: 1px solid var(--border-subtle-light);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.08);
    }

    <style>

/* =========================
   FORM LAYOUT CONTAINER
========================= */
.form-section {
  background: rgba(255,255,255,0.04);
  padding: 28px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  margin-bottom: 32px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
}

/* Section Title */
.form-section h2 {
  font-size: 22px;
  margin-bottom: 6px;
}

/* Section subtitle */
.form-section p {
  font-size: 14px;
  opacity: 0.7;
  margin-bottom: 18px;
}

/* =========================
   CLASSIC TWO-COLUMN GRID
========================= */
.form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 22px 28px;
  width: 85%;
  margin: auto;
}

@media (max-width: 900px) {
  .form-grid { grid-template-columns: 1fr; }
}

/* =========================
   LABEL CHIP STYLE
========================= */
.label-chip {
  display: inline-block;
  padding: 4px 10px;
  background: rgba(255,255,255,0.08);
  border-radius: 12px;
  font-size: 13px;
  margin-bottom: 6px;
  border: 1px solid rgba(255,255,255,0.15);
}

/* =========================
   INPUT FIELD STYLING
========================= */
/* Make fields shorter */
.form-input.short,
.form-select.short {
  width: 95%;
  padding: 10px 12px;
  background: white;
  color: #111;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #cbd5e1;
  outline: none;
}

.form-input:focus, 
.form-select:focus {
  border-color: #306cde;
  box-shadow: 0 0 0 2px rgba(48,108,222,0.25);
}

/* =========================
   PORTRAIT + ID IMAGES
========================= */
/* Portrait center */
.photo-center {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.portrait-wrapper {
  width: 160px;
  height: 160px;
  margin: 0 auto 10px;
  border-radius: 100%;
  border: 2px solid rgba(255,255,255,0.4);
  overflow: hidden;
  background: rgba(255,255,255,0.15);
}

.portrait-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
/* Full-width rows (portrait & button) */
.full-row {
  grid-column: 1 / -1;
}
    
/* Small ID preview */
.small-id {
  width: 90px;
  height: 60px;
  border-radius: 6px;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.25);
  object-fit: cover;
}

/* =========================
   NEXT BUTTON ALIGNMENT
========================= */
.next-btn {
  background: #306CDE;
  padding: 12px 26px;
  font-size: 15px;
  border-radius: 10px;
  border: none;
  color: white;
  margin-top: 20px;
  cursor: pointer;
  float: right;
  box-shadow: 0 8px 20px rgba(48,108,222,0.4);
}

.next-btn:hover {
  background: #3e7cff;
}
</style>

</head>

<body class="theme-dark">

  <div class="shell">

    <!-- ============================= -->
    <!-- SIDEBAR (FUNERAL MANAGEMENT) -->
    <!-- ============================= -->
    <aside class="sidebar">

      <div class="brand-block">
        <div class="brand-title">W.E. FUNERAL</div>
        <div class="brand-sub">Service Console</div>
      </div>

      <div>
        <div class="nav-section-label">Funeral Management</div>
        <ul class="nav-list">
          <li class="nav-item active" data-target="section-deceased">üïäÔ∏è Deceased Information</li>
          <li class="nav-item" data-target="section-nok">üë• Next of Kin</li>
          <li class="nav-item" data-target="section-funeral-type">‚ö∞Ô∏è Funeral Type</li>
          <li class="nav-item" data-target="section-services">üìú Service & Burial / Cremation</li>
          <li class="nav-item" data-target="section-shipment">‚úàÔ∏è Shipment / Repatriation</li>
          <li class="nav-item" data-target="section-costs">üí≤ Costs & Payments</li>
          <li class="nav-item" data-target="section-documents">üìÑ Documents</li>
          <li class="nav-item" data-target="section-pdf">üßæ PDF Auto-Fill</li>
          <li class="nav-item" data-target="section-review">‚úÖ Review & Submit</li>
        </ul>
      </div>

      <div class="sidebar-footer">
        W.E. Funeral Platform ¬© <span id="yearSpan"></span>
      </div>

    </aside>

    <!-- ============================= -->
    <!-- MAIN AREA -->
    <!-- ============================= -->
    <main class="main">

      <!-- TOP BAR -->
      <header class="topbar">
        <div class="topbar-left">
          <div class="page-title">Create New Funeral Record</div>
          <div class="page-subtitle">Enter, review, and manage all funeral arrangement details.</div>
        </div>

        <div class="topbar-right">
          <div class="avatar-chip">
            <div class="avatar-circle"></div>
            <span>Admin</span>
          </div>
        </div>
      </header>

      <!-- MAIN CONTENT AREA (sections will be inserted next) -->
      <div id="contentArea">
        <!-- PART A ‚Äî 2/2 will continue from here -->
<!-- ===================================================== -->
<!-- FUNERAL FORM SECTIONS (STRUCTURE ONLY FOR NOW)        -->
<!-- ===================================================== -->

<!-- SECTION 1 ‚Äî DECEASED INFORMATION -->
    <!-- Form fields added in PART B -->

 <div class="form-section" id="section-deceased">

  <h2>üïäÔ∏è Deceased Information</h2>
  <p>Enter full legal and identification information for the deceased.</p>

  <div class="form-grid">

    <!-- CENTERED PORTRAIT -->
    <div class="full-row photo-center">
      <div class="portrait-wrapper">
        <img id="portraitPreview" src="" alt="">
      </div>
      <div class="label-chip">Portrait Photo</div>
      <input type="file" onchange="previewImage(this,'portraitPreview')" />
    </div>

    <!-- Reference + Director -->
    <div>
      <div class="label-chip">Reference Number</div>
      <input id="refNumber" class="form-input short" readonly />
    </div>

    <div>
      <div class="label-chip">Responsible Funeral Director</div>
      <select id="funeralDirector" class="form-select short">
        <option>Select‚Ä¶</option>
        <option>Carl Brathwaite</option>
        <option>Winston Edwards</option>
      </select>
    </div>

    <!-- ID Images -->
    <div>
      <div class="label-chip">ID Front</div>
      <img id="idFrontPreview" class="small-id" />
      <input type="file" onchange="previewImage(this,'idFrontPreview')" />
    </div>

    <div>
      <div class="label-chip">ID Back</div>
      <img id="idBackPreview" class="small-id" />
      <input type="file" onchange="previewImage(this,'idBackPreview')" />
    </div>

    <!-- Full Name + Alias -->
    <div>
      <div class="label-chip">Full Name</div>
      <input id="fullName" class="form-input short" type="text" />
    </div>

    <div>
      <div class="label-chip">Alias / Other Names</div>
      <input id="alias" class="form-input short" type="text" />
    </div>

    <!-- Gender + Marital -->
    <div>
      <div class="label-chip">Gender</div>
      <select id="gender" class="form-select short">
        <option>Select‚Ä¶</option>
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>
    </div>

    <div>
      <div class="label-chip">Marital Status</div>
      <select id="maritalStatus" class="form-select short">
        <option>Select‚Ä¶</option>
        <option>Single</option>
        <option>Married</option>
        <option>Divorced</option>
        <option>Widowed</option>
      </select>
    </div>

    <!-- Date of Birth + Date of Death -->
    <div>
      <div class="label-chip">Date of Birth</div>
      <input id="dob" class="form-input short" type="date" onchange="calculateAge()" />
    </div>

    <div>
      <div class="label-chip">Date & Time of Death</div>
      <input id="dod" class="form-input short" type="datetime-local" onchange="calculateAge()" />
    </div>

    <!-- Age + Country -->
    <div>
      <div class="label-chip">Age</div>
      <input id="age" class="form-input short" readonly />
    </div>

    <div>
      <div class="label-chip">Country of Death</div>
      <select id="countryOfDeath" class="form-select short">
        <option>Barbados</option>
        <option>Trinidad & Tobago</option>
        <option>Jamaica</option>
        <option>United States</option>
      </select>
    </div>

    

  </div>
</div>



<!-- SECTION 2 ‚Äî NEXT OF KIN -->
<section id="section-nok" class="content-card">
  <h2>Next of Kin</h2>
  <p class="section-description">
    List primary and secondary contact persons responsible for arrangements.
  </p>

  <div class="section-placeholder">
    <em>Next of Kin fields will appear here.</em>
  </div>
</section>

<!-- SECTION 3 ‚Äî FUNERAL TYPE -->
<section id="section-funeral-type" class="content-card">
  <h2>Funeral Type</h2>
  <p class="section-description">
    Select the funeral arrangement and automatically display relevant options.
  </p>

  <div class="section-placeholder">
    <em>Funeral Type form fields go here.</em>
  </div>
</section>

<!-- SECTION 4 ‚Äî SERVICE & BURIAL / CREMATION -->
<section id="section-services" class="content-card">
  <h2>Service, Burial & Cremation Details</h2>
  <p class="section-description">
    Add service details such as clergy, venue, cemetery, crematorium info, and timings.
  </p>
  <div class="section-placeholder">
    <em>Service & Burial fields will go here.</em>
  </div>
</section>

<!-- SECTION 5 ‚Äî SHIPMENT / REPATRIATION -->
<section id="section-shipment" class="content-card">
  <h2>Shipment / Repatriation Details</h2>
  <p class="section-description">
    Airline info, international funeral home details, consular data, etc.
  </p>
  <div class="section-placeholder">
    <em>Shipment & Repatriation fields will go here.</em>
  </div>
</section>

<!-- SECTION 6 ‚Äî COSTS & PAYMENTS -->
<section id="section-costs" class="content-card">
  <h2>Costs & Payments</h2>
  <p class="section-description">
    Itemize funeral expenses and calculate totals, deposits, and outstanding balances.
  </p>
  <div class="section-placeholder">
    <em>Costs & Payment fields will go here.</em>
  </div>
</section>

<!-- SECTION 7 ‚Äî DOCUMENTS -->
<section id="section-documents" class="content-card">
  <h2>Documents</h2>
  <p class="section-description">
    Upload ID cards, police reports, medical certificates, and supporting files.
  </p>
  <div class="section-placeholder">
    <em>Document upload fields go here.</em>
  </div>
</section>

<!-- SECTION 8 ‚Äî PDF AUTO-FILL -->
<section id="section-pdf" class="content-card">
  <h2>PDF Auto-Fill</h2>
  <p class="section-description">
    Select the government PDF form to automatically populate with funeral details.
  </p>
  <div class="section-placeholder">
    <em>PDF selection and preview will go here.</em>
  </div>
</section>

<!-- SECTION 9 ‚Äî REVIEW & SUBMIT -->
<section id="section-review" class="content-card">
  <h2>Review & Submit</h2>
  <p class="section-description">
    Final validation and submission of the complete funeral record.
  </p>
  <div class="section-placeholder">
    <em>Review summary goes here.</em>
  </div>
</section>


</div> <!-- END contentArea -->
</main> <!-- END main -->
</div> <!-- END shell -->

<!-- ========================================= -->
<!-- JAVASCRIPT ‚Äî ACTIVE STATE + SCROLL LOGIC -->
<!-- ========================================= -->
<script>
/* -------------------------
   YEAR AUTO-FILL
-------------------------- */
document.getElementById("yearSpan").textContent = new Date().getFullYear();

/* -------------------------
   SIDEBAR NAVIGATION
-------------------------- */
const navItems = document.querySelectorAll(".nav-item");

navItems.forEach(item => {
  item.addEventListener("click", () => {
    // Remove active from all
    navItems.forEach(i => i.classList.remove("active"));

    // Add active to clicked item
    item.classList.add("active");

    // Scroll to target section
    const target = item.getAttribute("data-target");
    const section = document.getElementById(target);

    if (section) {
      section.scrollIntoView({ behavior: "smooth", block: "start" });
    }
  });
});

/* --------------------------------------------------
   OBSERVER: HIGHLIGHT SIDEBAR item when scrolling
--------------------------------------------------- */
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    const id = entry.target.id;
    const navItem = document.querySelector(`.nav-item[data-target="${id}"]`);

    if (entry.isIntersecting) {
      navItems.forEach(i => i.classList.remove("active"));
      if (navItem) navItem.classList.add("active");
    }
  });
}, { threshold: 0.4 });

document.querySelectorAll("section").forEach(section => {
  observer.observe(section);
});
</script>
<script>
/* MULTI-STEP FUNCTIONALITY ---------------------------------- */

const sections = [
  "section-deceased",
  "section-nok",
  "section-funeral-type",
  "section-services",
  "section-shipment",
  "section-costs",
  "section-documents",
  "section-pdf",
  "section-review"
];

let currentStep = 0;

// Show first step on load
document.addEventListener("DOMContentLoaded", () => {
  showStep(0);
});

function showStep(index) {
  currentStep = index;

  sections.forEach((id, i) => {
    const section = document.getElementById(id);
    if (!section) return;

    if (i === index) {
      section.classList.add("active-step");
    } else {
      section.classList.remove("active-step");
    }
  });

  // Highlight sidebar
  document.querySelectorAll(".nav-item").forEach(item => {
    const target = item.getAttribute("data-target");
    item.classList.toggle("active", target === sections[index]);
  });

  // Inject buttons
  injectStepButtons(index);
}

function injectStepButtons(index) {
  const section = document.getElementById(sections[index]);

  // Remove existing nav row
  const existing = section.querySelector(".step-nav");
  if (existing) existing.remove();

  // Create new button row
  const nav = document.createElement("div");
  nav.className = "step-nav";

  // Back button
  if (index > 0) {
    const back = document.createElement("button");
    back.className = "step-btn secondary";
    back.textContent = "‚Üê Back";
    back.onclick = () => showStep(index - 1);
    nav.appendChild(back);
  } else {
    // Placeholder for layout alignment
    const spacer = document.createElement("div");
    nav.appendChild(spacer);
  }

  // Next button
  if (index < sections.length - 1) {
    const next = document.createElement("button");
    next.className = "step-btn primary";
    next.textContent = "Next ‚Üí";
    next.onclick = () => showStep(index + 1);
    nav.appendChild(next);
  } else {
    const finish = document.createElement("button");
    finish.className = "step-btn primary";
    finish.textContent = "Submit Record";
    finish.onclick = () => alert("Submitting final funeral record‚Ä¶");
    nav.appendChild(finish);
  }

  section.appendChild(nav);
}

/* SIDEBAR Integration: clicking navigates to step */
document.querySelectorAll(".nav-item").forEach((item, index) => {
  item.addEventListener("click", () => {
    showStep(index);
  });
});
</script>
<script>
/* ================================
   IMAGE PREVIEW HELPERS
================================ */
function previewImage(input, previewId) {
  const file = input.files && input.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = e => {
    const img = document.getElementById(previewId);
    if (img) img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

/* ================================
   AGE CALCULATION (DOD - DOB)
================================ */
function calculateAge() {
  const dobEl = document.getElementById("d_dob");
  const dodEl = document.getElementById("d_dod");
  const ageEl = document.getElementById("d_age");

  if (!dobEl || !dodEl || !ageEl) return;

  const dob = dobEl.value;
  const dod = dodEl.value;
  if (!dob || !dod) {
    ageEl.value = "";
    return;
  }

  const birth = new Date(dob);
  const death = new Date(dod);

  if (isNaN(birth.getTime()) || isNaN(death.getTime())) {
    ageEl.value = "";
    return;
  }

  let age = death.getFullYear() - birth.getFullYear();
  const m = death.getMonth() - birth.getMonth();
  if (m < 0 || (m === 0 && death.getDate() < birth.getDate())) {
    age--;
  }

  ageEl.value = age >= 0 ? age : "";
}

/* ================================
   MARITAL STATUS ‚Üí SPOUSE FIELD
================================ */
function toggleSpouseField() {
  const statusEl = document.getElementById("d_maritalStatus");
  const spouseField = document.getElementById("spouseField");
  if (!statusEl || !spouseField) return;

  const show = statusEl.value === "Married";
  spouseField.style.display = show ? "block" : "none";
}

/* ================================
   CERTIFICATE ISSUED ‚Üí NUMBER
================================ */
function toggleCertificateNumber() {
  const certEl = document.getElementById("d_certificateIssued");
  const certField = document.getElementById("certificateNumberField");
  if (!certEl || !certField) return;

  const show = certEl.value === "Yes";
  certField.style.display = show ? "block" : "none";
}

/* ================================
   COUNTRY LIST POPULATION
================================ */
const countries = [
  "Barbados","United States","United Kingdom","Canada","Jamaica",
  "Trinidad & Tobago","Guyana","Saint Lucia","Dominica","Grenada",
  "St. Vincent & the Grenadines","Antigua & Barbuda","St. Kitts & Nevis",
  "Bahamas","Belize","Suriname","France","Germany","Spain","Italy","Netherlands",
  "Brazil","Mexico","Nigeria","Ghana","South Africa","India","China","Australia",
  "New Zealand","Japan"
];

function loadCountriesIntoSelect(id) {
  const sel = document.getElementById(id);
  if (!sel) return;

  // Only populate if it's still on default state
  if (sel.options.length <= 1) {
    countries.forEach(c => {
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      sel.appendChild(opt);
    });
  }
}

function initCountries() {
  loadCountriesIntoSelect("d_countryOfDeath");
  loadCountriesIntoSelect("d_countryOfResidence");
}

/* ================================
   REFERENCE NUMBER GENERATOR
================================ */
function generateRefNumber() {
  const refEl = document.getElementById("d_refNumber");
  if (!refEl) return;

  if (!refEl.value) {
    const rand = Math.floor(100000 + Math.random() * 900000);
    refEl.value = "REF-" + rand;
  }
}

/* ================================
   INITIALIZE ON PAGE LOAD
================================ */
document.addEventListener("DOMContentLoaded", () => {
  initCountries();
  generateRefNumber();
});

  function previewImage(input, target) {
  const file = input.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => document.getElementById(target).src = e.target.result;
  reader.readAsDataURL(file);
}

function calculateAge() {
  const dob = new Date(document.getElementById("dob").value);
  const dod = new Date(document.getElementById("dod").value);

  if (!dob || !dod) return;

  let age = dod.getFullYear() - dob.getFullYear();
  const m = dod.getMonth() - dob.getMonth();

  if (m < 0 || (m === 0 && dod.getDate() < dob.getDate())) {
    age--;
  }

  document.getElementById("age").value = age + " years";
}
  
  document.addEventListener("DOMContentLoaded", () => {
  generateReferenceNumber();
});

document.addEventListener("DOMContentLoaded", () => {
  generateReferenceNumber();
});

function generateReferenceNumber() {
  const ref = "REF-" + Math.floor(100000 + Math.random() * 900000);
  document.getElementById("refNumber").value = ref;
}
</script>
</body>
</html>
